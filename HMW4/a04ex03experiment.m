eps=0.001;
N=[5,50,500,5000];
err = ones(4,1);
%uniform+D+
figure(1)
for i=1:4
    h=0.5/N(i);
    xh1=h*[1:2*N(i)-1]';
    uh1_ap = a04ex03solve(eps,xh1,'+');
    [err(i),uh1_ex] = a04ex03error(eps,xh1,uh1_ap);
    plot(xh1,uh1_ap,'.')
    legend(['Aprox N=' num2str(N(i)) ', error ='...
        num2str(err(i))])
    hold on
    plot(xh1,uh1_ex)
end
title('D+ uniform grid')
legend(['Aprox N=5, error =' num2str(err(1))],...
    'Exact N=5',...
    ['Aprox N=50, error =' num2str(err(2))],...
    'Exact N=50',...
    ['Aprox N=500, error =' num2str(err(3))],...
    'Exact N=500',...
    ['Aprox N=5000, error =' num2str(err(4))],...
    'Exact N=5000',...
    'location', 'best')
%uniform+D- 
figure(2)
for i=1:4
    h=0.5/N(i);
    xh2=h.*[1:2*N(i)-1]';
    uh2_ap = a04ex03solve(eps,xh2,'-');
    [err(i),uh2_ex] = a04ex03error(eps,xh2,uh2_ap);
    plot(xh2,uh2_ap,'.')
    hold on
    plot(xh2,uh2_ex)
end
title('D- uniform grid')
legend(['Aprox N=5, error =' num2str(err(1))],...
    'Exact N=5',...
    ['Aprox N=50, error =' num2str(err(2))],...
    'Exact N=50',...
    ['Aprox N=500, error =' num2str(err(3))],...
    'Exact N=500',...
    ['Aprox N=5000, error =' num2str(err(4))],...
    'Exact N=5000',...
    'location', 'best')
%
%uniform+D0
figure(3)
for i=1:4
    h=0.5/N(i);
    xh3=h.*[1:2*N(i)-1]';
    uh3_ap = a04ex03solve(eps,xh3,'0');
    [err(i),uh3_ex] = a04ex03error(eps,xh3,uh3_ap);
    plot(xh3,uh3_ap,'.')
    hold on
    plot(xh3,uh3_ex)
end
title('D0 uniform grid')
legend(['Aprox N=5, error =' num2str(err(1))],...
    'Exact N=5',...
    ['Aprox N=50, error =' num2str(err(2))],...
    'Exact N=50',...
    ['Aprox N=500, error =' num2str(err(3))],...
    'Exact N=500',...
    ['Aprox N=5000, error =' num2str(err(4))],...
    'Exact N=5000',...
    'location', 'best')
%
legend_str=[];
figure(4)
for i=1:4
    sigma=4*eps*log(2*N(i));
    xh4=a04ex03shishkin(N(i),sigma);
    uh4_ap = a04ex03solve(eps,xh4,'0');
    [err(i),uh4_ex] = a04ex03error(eps,xh4,uh4_ap);
    plot(xh4,uh4_ap,'.')
    hold on
    plot(xh3,uh3_ex)
end
title('D0 Shishkin grid')
legend(['Aprox N=5, error =' num2str(err(1))],...
    'Exact N=5',...
    ['Aprox N=50, error =' num2str(err(2))],...
    'Exact N=50',...
    ['Aprox N=500, error =' num2str(err(3))],...
    'Exact N=500',...
    ['Aprox N=5000, error =' num2str(err(4))],...
    'Exact N=5000',...
    'location', 'best')

